#!/bin/bash
#SBATCH -J Cuda_Job
#SBATCH -p cuda
#SBATCH -o dsssp-%j.out
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --gres=gpu:1
#SBATCH --time=04:00:00
#SBATCH --mem=32000M

echo "start"

cp rmat248_sorted_ext rmat248_sorted_ext_x
awk '$4==1 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_0 >> rmat248_sorted_ext_x
sort -n -k1 -k2 rmat248_sorted_ext_x | uniq > rmat248_sorted_ext_xy
awk '$4==0 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_0 > rmat248_cE_50M_0_del
sort -n -k1 -k2 rmat248_cE_50M_0_del | uniq > rmat248_cE_50M_0_del_xy
diff rmat248_sorted_ext_xy rmat248_cE_50M_0_del_xy | grep "<" | sed 's/^<//g' > rmat248_50M_0
awk '{print $1+1" "$2+1" "$3}' rmat248_50M_0 > rmat248_50M_0.mtx
rm rmat248_sorted_ext_x
rm rmat248_sorted_ext_xy
rm rmat248_cE_50M_0_del
rm rmat248_cE_50M_0_del_xy
rm rmat248_50M_0

cp rmat248_sorted_ext rmat248_sorted_ext_x
awk '$4==1 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_25 >> rmat248_sorted_ext_x
sort -n -k1 -k2 rmat248_sorted_ext_x | uniq > rmat248_sorted_ext_xy
awk '$4==0 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_25 > rmat248_cE_50M_25_del
sort -n -k1 -k2 rmat248_cE_50M_25_del | uniq > rmat248_cE_50M_25_del_xy
diff rmat248_sorted_ext_xy rmat248_cE_50M_25_del_xy | grep "<" | sed 's/^<//g' > rmat248_50M_25
awk '{print $1+1" "$2+1" "$3}' rmat248_50M_25 > rmat248_50M_25.mtx
rm rmat248_sorted_ext_x
rm rmat248_sorted_ext_xy
rm rmat248_cE_50M_25_del
rm rmat248_cE_50M_25_del_xy
rm rmat248_50M_25

cp rmat248_sorted_ext rmat248_sorted_ext_x
awk '$4==1 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_50 >> rmat248_sorted_ext_x
sort -n -k1 -k2 rmat248_sorted_ext_x | uniq > rmat248_sorted_ext_xy
awk '$4==0 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_50 > rmat248_cE_50M_50_del
sort -n -k1 -k2 rmat248_cE_50M_50_del | uniq > rmat248_cE_50M_50_del_xy
diff rmat248_sorted_ext_xy rmat248_cE_50M_50_del_xy | grep "<" | sed 's/^<//g' > rmat248_50M_50
awk '{print $1+1" "$2+1" "$3}' rmat248_50M_50 > rmat248_50M_50.mtx
rm rmat248_sorted_ext_x
rm rmat248_sorted_ext_xy
rm rmat248_cE_50M_50_del
rm rmat248_cE_50M_50_del_xy
rm rmat248_50M_50

cp rmat248_sorted_ext rmat248_sorted_ext_x
awk '$4==1 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_75 >> rmat248_sorted_ext_x
sort -n -k1 -k2 rmat248_sorted_ext_x | uniq > rmat248_sorted_ext_xy
awk '$4==0 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_75 > rmat248_cE_50M_75_del
sort -n -k1 -k2 rmat248_cE_50M_75_del | uniq > rmat248_cE_50M_75_del_xy
diff rmat248_sorted_ext_xy rmat248_cE_50M_75_del_xy | grep "<" | sed 's/^<//g' > rmat248_50M_75
awk '{print $1+1" "$2+1" "$3}' rmat248_50M_75 > rmat248_50M_75.mtx
rm rmat248_sorted_ext_x
rm rmat248_sorted_ext_xy
rm rmat248_cE_50M_75_del
rm rmat248_cE_50M_75_del_xy
rm rmat248_50M_75

cp rmat248_sorted_ext rmat248_sorted_ext_x
awk '$4==1 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_100 >> rmat248_sorted_ext_x
sort -n -k1 -k2 rmat248_sorted_ext_x | uniq > rmat248_sorted_ext_xy
awk '$4==0 {print $1" "$2" "$3}' ../R24/changedEdges_r24_50M_100 > rmat248_cE_50M_100_del
sort -n -k1 -k2 rmat248_cE_50M_100_del | uniq > rmat248_cE_50M_100_del_xy
diff rmat248_sorted_ext_xy rmat248_cE_50M_100_del_xy | grep "<" | sed 's/^<//g' > rmat248_50M_100
awk '{print $1+1" "$2+1" "$3}' rmat248_50M_100 > rmat248_50M_100.mtx
rm rmat248_sorted_ext_x
rm rmat248_sorted_ext_xy
rm rmat248_cE_50M_100_del
rm rmat248_cE_50M_100_del_xy
rm rmat248_50M_100

echo "completed"